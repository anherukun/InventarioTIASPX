
@{
    ViewBag.Title = "Computer";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    InventarioTIASPX.Models.Computer computer = ViewData["computer"] as InventarioTIASPX.Models.Computer;
    List<InventarioTIASPX.Models.FileObject> files = ViewData["files"] as List<InventarioTIASPX.Models.FileObject>;
}

<h2>Equipo de computo</h2>

<div class="row" style="margin-top: 32px">
    <div class="row">
        <!--Links-->
        <div class="col-md-8">
            <div class="panel panel-default" style="padding:0px; margin-top: 16px;">
                <div class="panel-body">
                    <!--DATOS DEL EQUIPO-->
                    <h3 style="margin-top:0px;">Datos del equipo</h3>
                    <div class="row" style="margin-left:16px;">
                        <div class="col-md-4">
                            <label>Serie del procesador</label>
                            <p style="margin-left:8px;">@computer.Processor.DeviceId</p>
                        </div>

                        <div class="col-md-4">
                            <label>Modelo del procesador</label>
                            <p style="margin-left:8px;">@computer.Processor.Model</p>
                        </div>

                        <div class="col-md-4">
                            <label>Marca/Fabricante</label>
                            <p style="margin-left:8px;">@computer.Processor.Brand</p>
                        </div>

                        <div class="col-md-4">
                            <label>Hostname</label>
                            <p style="margin-left:8px;">@computer.Hostname</p>
                        </div>

                        <div class="col-md-4">
                            <label>Arquitectura del sistema</label>
                            <p style="margin-left:8px;">@computer.Architecture BITS</p>
                        </div>
                    </div>

                    <!--OTROS DATOS-->
                    <h3 style="margin-top:0px;">Otros datos</h3>
                    <div class="row" style="margin-left:16px;">
                        <div class="col-md-4">
                            <label>Departamento</label>
                            <p style="margin-left:8px;">@computer.Department</p>
                        </div>

                        <div class="col-md-4">
                            <label>Ubicacion fisica</label>
                            <p style="margin-left:8px;">@computer.Location</p>
                        </div>
                    </div>

                    <!--ACCESORIOS DEL EQUIPO-->
                    @if (computer.Devices != null)
                    {
                        <h3>Accesorios del equipo</h3>

                        <table class="table" id="devicetable">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        Dispositivo
                                        <br />
                                    </th>

                                    <th scope="col">
                                        Fabricante
                                        <br />
                                    </th>

                                    <th scope="col" style="width:100px">
                                        Modelo
                                        <br />
                                    </th>

                                    <th scope="col">
                                        Serie
                                        <br />
                                    </th>

                                    <th scope="col" style="width:180px">
                                        Acciones
                                        <br />
                                    </th>

                                </tr>
                            </thead>

                            <tbody>
                                @foreach (var item in computer.Devices)
                                {
                                    if (item.Type != "PROCESADOR" && item.Type != "LAPTOP")
                                    {
                                        <tr>
                                            <td scope="row">@item.Type</td>
                                            <td>@item.Brand</td>
                                            <td>@item.Model</td>
                                            <td>@item.DeviceId</td>
                                            <td style="text-align:right;">
                                                @Html.ActionLink("Ver mas...", "Device", "Devices", new { deviceId = item.DeviceId }, new { @class = "btn btn-default btn-sm hidden-print" })
                                                @Html.ActionLink("Remover", "UnassignComputer", "Devices", new { deviceId = item.DeviceId, redirect = Url.Action("Computer", "Computers", new { computerId = computer.ComputerId }) }, new { @class = "btn btn-danger btn-sm hidden-print" })
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    }

                    @Html.ActionLink("Editar", "EditComputer", "Computers", new { computerId = computer.ComputerId }, new { @class = "btn btn-primary" })
                </div>
            </div>

            <div class="panel panel-default" style="padding:0px; margin-top: 16px;">
                <div class="panel-body">
                    <!--ARCHIVOS-->
                    <h3 style="margin-top:0px">Datos adjuntos</h3>

                    <table class="table" id="devicetable">
                        <thead>
                            <tr>
                                <th scope="col">
                                    Nombre de archivo
                                    <br />
                                </th>

                                <th scope="col">
                                    Tamaño
                                    <br />
                                </th>

                                <th scope="col" style="width:100px">
                                    Cargado
                                    <br />
                                </th>

                                <th scope="col" style="width:180px">
                                    Acciones
                                    <br />
                                </th>

                            </tr>
                        </thead>
                        @if (files != null)
                        {
                            <tbody>
                                @foreach (var item in files)
                                {
                                    <tr>
                                        <td scope="row">@item.Name</td>
                                        <td>@(item.Size / 1024) KB</td>
                                        <td>@(new DateTime(item.UploadedTicks).ToString())</td>
                                        <td style="text-align:right;">
                                            @Html.ActionLink("Descargar", "DownloadFromComputersFiles", "Files", new { fileId = item.FileId }, new { @class = "btn btn-default btn-sm hidden-print" })
                                            @Html.ActionLink("Eliminar", "DeleteFromComputersFiles", "Files", new { fileId = item.FileId, redirect = Url.Action("Computer", "Computers", new { computerId = computer.ComputerId }) }, new { @class = "btn btn-danger btn-sm hidden-print" })
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        }
                    </table>

                    @using (Html.BeginForm("UploadComputerFile", "Files", FormMethod.Post, new { @class = "form-inline", id = "form", onsubmit = "", enctype = "multipart/form-data" }))
                    {
                        <div class="form-group" style="display:none;">
                            <label>ParenId</label>
                            <input class="form-control" name="parentId" value="@computer.ComputerId" readonly />
                        </div>
                        <div class="form-group" style="display:none;">
                            <label>Redirect</label>
                            <input class="form-control" name="redirect" value="@Url.Action("Computer", "Computers", new { computerId = computer.ComputerId})" readonly />
                        </div>
                        <div class="form-group" style="display:none;">
                            <label>Route</label>
                            <input class="form-control" name="path" value="Computer" readonly />
                            <input class="form-control" name="controller" value="Computers" readonly />
                        </div>
                        <div class="form-group col-md-12" style="text-align:end; padding-right:0px">
                            <label>Subir archivo - Max. 4MB(4096 KB)</label>
                            <input class="form-control form-group-sm" id="id" type="file" name="file" value="" />
                            <input class="btn btn-success" type="submit" value="Cargar" />
                        </div>
                    }
                </div>
            </div>
        </div>

        <!--SIDE PANEL-->
        <div class="col-md-4">
            <div class="panel panel-default" style="padding:0px; margin-top: 16px;">
                <a href="#glosary" data-toggle="collapse">
                    <div class="panel-heading" style="padding:16px;">
                        <h3 style="margin-top:0px; margin-bottom:0px;"><span class="glyphicon glyphicon-question-sign"></span> Glosario <span class="caret"></span></h3>
                    </div>
                </a>
                <div class="panel-body collapse" id="glosary">
                    <ul>
                        <li>
                            <label>Datos del equipo</label>
                            <p>Muestra la informacion registrada del equipo</p>
                        </li>

                        <li>
                            <label>Accessorios del equipo</label>
                            <p>Muestra los dispositivos que pertenecen al equipo de computo, exceptuando las catogorias de: Laptop y Procesador</p>
                        </li>

                        <li>
                            <label>Datos adjuntos</label>
                            <p>Permite adjuntar documentos o archivos relacionados al equipo de computo y/o sus dependientes, tales como Responsivas, Manuales, Fotografias, Etc. <br />El tamaño por archivo debe ser estrictamente menor o igual a 4MB (4096KB)</p>
                        </li>
                    </ul>
                </div>
            </div>

            <div>
                <!--SNACK DE ALERTAS-->
                <div class="alert alert-danger" id="error-alert-snack" role="alert" style="margin-top: 16px; display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    Debes completar correctamente el formulario
                </div>
                <div class="alert alert-success" id="success-alert-snack" role="alert" style="margin-top: 16px; display:none;">
                    <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
                    Los cambios se han guardado correctamente
                </div>

                @if (ViewData["message"] != null)
                {
                    <script type="text/javascript">
                        retriveMessage();
                    </script>
                }
            </div>
        </div>
    </div>
</div>