
@{
    ViewBag.Title = "Catalogo de usuarios";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{ 
    List<InventarioTIASPX.Models.User> users = ViewData["users"] as List<InventarioTIASPX.Models.User>;
}

<h2>@ViewBag.Title</h2>

<ul class="nav nav-pills">
    <li role="presentation"><a href="@Url.Action("", "")">Ir al menu</a></li>
    <li role="presentation"><a href="@Url.Action("NewUser", "Users")">Agregar usuario</a></li>
</ul>

<table class="table" id="devicetable">
    <thead>
        <tr>
            <th scope="col" style="min-width:120px;">
                Usuario de AD
            </th>

            <th scope="col">
                Nombre de la cuenta
            </th>

            <th scope="col">
                Correo electronico
            </th>

            <th scope="col">
                Titular
            </th>

            <th scope="col" style="width:275px;">
                Acciones
                <button class="btn btn-default hidden-print" onclick="ClearFilters()" style="display:none;"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Quitar filtros</button>
                <button class="btn btn-default hidden-print" onclick="ApplyFilters()" style="display:none;"><span class="glyphicon glyphicon-filter" aria-hidden="true"></span> Aplicar filtros</button>
            </th>

        </tr>
    </thead>
    @if (users.Count > 0)
    {
        <tbody>
            @{
                foreach (var item in users)
                {
                    <tr>
                        <td scope="row">@item.UserId</td>
                        <td>@item.Name</td>
                        <td>@item.Email</td>
                        <td>@item.Employe</td>
                        <td style="text-align:right;">
                            @Html.ActionLink("Ver mas...", "User", "Users", new { userId = item.UserId }, new { @class = "btn btn-default btn-sm hidden-print" })
                            @Html.ActionLink("Modificar", "EditUser", "Users", new { userId = item.UserId }, new { @class = "btn btn-default btn-sm hidden-print" })
                            @Html.ActionLink("Eliminar", "DeleteUser", "Users", new { userId = item.UserId }, new { @class = "btn btn-danger btn-sm hidden-print" })
                        </td>
                    </tr>
                }
            }
        </tbody>
    }
</table>

<script type="text/javascript">
    function ClearFilters() {
        document.getElementById("filter-1").value = "";
        document.getElementById("filter-2").value = "";
        document.getElementById("filter-3").value = "";
        document.getElementById("filter-4").value = "";
        RemoveFilters()
    }
    function RemoveFilters() {
        FilterBy("", 0);
        FilterBy("", 1);
        FilterBy("", 2);
        FilterBy("", 3);
    }
    function ApplyFilters() {
        RemoveFilters();
        // col-0
        if (document.getElementById("filter-1").value.trim() != "") {
            FilterBy(document.getElementById("filter-1").value, 0);
        }
        // col-1
        if (document.getElementById("filter-2").value.trim() != "") {
            FilterBy(document.getElementById("filter-2").value, 1);
        }
        // col-2
        if (document.getElementById("filter-3").value.trim() != "") {
            FilterBy(document.getElementById("filter-3").value, 2);
        }
        // col-3
        if (document.getElementById("filter-4").value.trim() != "") {
            FilterBy(document.getElementById("filter-4").value, 3);
        }

    }
    function FilterBy(str, col) {
        var table = document.getElementById("devicetable");
        var rows = table.getElementsByTagName("tbody")[0].getElementsByTagName("tr");
        for (var i = 0; i < rows.length; i++) {
            var cell = rows[i].getElementsByTagName("td")[col];

            if (str != "") {
                if (rows[i].style.display == "") {
                    if (cell.textContent.includes(str.trim().toUpperCase())) {
                        rows[i].style.display = "";
                    } else {
                        rows[i].style.display = "none";
                    }
                }
            } else {
                rows[i].style.display = "";
            }
        }
    }
</script>